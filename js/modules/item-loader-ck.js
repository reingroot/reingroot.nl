define(["jquery"],function(e){var t,n,r,i,s,o="970px",u="",a=!1,f=function(o){t=e(o);s=t.height();n=t.find(t.data("loaderContainer"));r=n.find(t.data("loaderItems"));t.css("position","relative");i=e("<section></section>").addClass("item-wrapper");t.append(i);t.on("webkitTransitionEnd transitionend transitionEnd msTransitionEnd oTransitionEnd",function(){switch(u){case"resize":a.find(".ajax-loading").remove();a=!1;l();break;case"slideOut":d();break;case"":v()}});r.on("click",function(t){var n=e(this),r=n.find("a").attr("href");n.append('<span class="ajax-loading"></span>');a=n;c(r,h);t.preventDefault()});var f;e(window).on("resize",function(){clearTimeout(f);f=setTimeout(function(){s=t.height()},500)})},l=function(){u="slideIn";var e=parseInt(i.css("left"));e!==0&&i.css("left",0)},c=function(n,r){var s=/\/(item)\//;n=n.replace(s,"/ajax_$1/");e.ajax({type:"POST",url:n,data:{},dataType:"html",beforeSend:function(){if(!a){t.append('<span class="ajax-loading"></span>');a=t}}}).done(function(t){i.html(t);i.find(".js-to-overview").on("click",function(e){p();e.preventDefault()});i.find(".js-to-next").on("click",function(t){var n=e(this),r=n.attr("href");c(r,h);t.preventDefault()});i.find(".js-to-previous").on("click",function(t){var n=e(this),r=n.attr("href");c(r,h);t.preventDefault()});r&&setTimeout(r,200)})},h=function(){u="resize";t.addClass("no-transition");t.height(t.height());var n,r=i.outerHeight(),s=t.outerHeight(),o=t.height();if(r>s){var a=s-o;n=r-a;setTimeout(function(){t.removeClass("no-transition");t.height(n+"px");m()||t.triggerHandler("transitionend")},0)}else if(r<s){i.addClass("no-transition");i.height(r);n=r+(s-r);setTimeout(function(){i.removeClass("no-transition");t.removeClass("no-transition");i.height(n+"px");m()||t.triggerHandler("transitionend")},0)}else setTimeout(function(){t.removeClass("no-transition");t.triggerHandler("transitionend")},0)},p=function(){u="slideOut";var e=t.outerWidth();i.css("left",e*-1-10+"px");m()||t.triggerHandler("transitionend")},d=function(){u="";i.addClass("no-transition");i.css("left",o).height("auto");if(t.height()>s){t.height(s+"px");m()||t.triggerHandler("transitionend")}else t.height()===parseInt(s)&&t.triggerHandler("transitionend");setTimeout(function(){i.removeClass("no-transition")},0)},v=function(){t.addClass("no-transition");t.height("auto");setTimeout(function(){t.removeClass("no-transition")},0)},m=function(){return"ontransitionend"in window?!0:"onwebkittransitionend"in window?!0:"onotransitionend"in window?!0:"onmstransitionend"in window};return{init:f,slideIn:l,load:c,slideOut:p}});