define(["jquery"],function(e){var t,n,r,i,s,o="970px",u="",a=function(o){t=e(o);s=t.height();n=t.find(t.data("loaderContainer"));r=n.find(t.data("loaderItems"));t.css("position","relative");i=e(document.createElement("section"));i.addClass("item-wrapper transition-height");t.append(i);t.on("webkitTransitionEnd transitionend transitionEnd msTransitionEnd oTransitionEnd",function(e){switch(u){case"resize":f();break;case"slideOut":p();break;case"":d()}});r.on("click",function(t){var n=e(this),r=n.find("a").attr("href");l(r,c);t.preventDefault()});var a;e(window).on("resize",function(){clearTimeout(a);a=setTimeout(function(){s=t.height()},500)})},f=function(){u="slideIn";var e=parseInt(i.css("left"));e!==0&&i.css("left",0)},l=function(t,n){var r=/\/(item)\//;t=t.replace(r,"/ajax_$1/");e.ajax({type:"POST",url:t,data:{},dataType:"html"}).done(function(t){i.html(t);i.find(".js-to-overview").on("click",function(e){h();e.preventDefault()});i.find(".js-to-next").on("click",function(t){var n=e(this),r=n.attr("href");l(r,c);t.preventDefault()});i.find(".js-to-previous").on("click",function(t){var n=e(this),r=n.attr("href");l(r,c);t.preventDefault()});n&&setTimeout(n,200)})},c=function(){u="resize";t.addClass("no-transition");t.height(t.height());var n,r=i.outerHeight(),s=t.outerHeight(),o=t.height();if(r>s){var a=s-o;n=r-a;setTimeout(function(){t.removeClass("no-transition");t.height(n+"px");v()||t.trigger("transitionend")},0)}else if(r<s){i.addClass("no-transition");i.height(r);n=r+(s-r);setTimeout(function(){i.removeClass("no-transition");i.height(n+"px");v()||t.trigger("transitionend")},0)}else setTimeout(function(){t.trigger("transitionend")},0)},h=function(){u="slideOut";var e=t.outerWidth();i.css("left",e*-1-10+"px");v()||t.trigger("transitionend")},p=function(){u="";i.addClass("no-transition");i.css("left",o).height("auto");if(t.height()>s){t.height(s+"px");v()||t.trigger("transitionend")}else t.height()===parseInt(s)&&t.trigger("transitionend");setTimeout(function(){i.removeClass("no-transition")},0)},d=function(){t.addClass("no-transition");t.height("auto");setTimeout(function(){t.removeClass("no-transition")},0)},v=function(){return"ontransitionend"in window?!0:"onwebkittransitionend"in window?!0:"onotransitionend"in window?!0:"onmstransitionend"in window?!0:!1};return{init:a,slideIn:f,load:l,slideOut:h}});